<section class="flex flex-column lg:flex-row h-screen overflow-hidden p-2 box-border bg-white">
  <div class="w-full lg:w-6 p-0 hidden lg:block h-full relative">
    <img class="w-full h-full block object-cover" src="/assets/images/auth.jpg" alt="Set password" />
    <div class="absolute bottom-0 left-0 p-4 lg:p-5 text-white">
      <h3 class="hero-title m-0">Set your password</h3>
      <p class="m-0 mt-2">You have been added as Admin or Instructor. Create a password to sign in.</p>
    </div>
  </div>

  <form class="w-full lg:w-6 h-full p-4 lg:p-6 flex flex-column justify-content-center gap-3 bg-white"
    [formGroup]="form" (ngSubmit)="submit()">
    <div class="flex justify-content-center lg:justify-content-start">
      <img src="/core/logo.svg" alt="SkillQuestX" class="w-15rem" />
    </div>
    <p-toast />
    <div>
      <h2 class="m-0">Set your password</h2>
      <p class="mt-2 mb-0">Create a password (at least 8 characters). After this you can log in.</p>
    </div>

    @if (!token()) {
      <p class="p-error">Invalid or missing set-password link. Request a new one from your admin.</p>
      <a pButton routerLink="/login" label="Go to Login" class="p-button-outlined"></a>
    } @else {
    <div class="flex flex-column gap-3">
      <div class="flex flex-column gap-1">
        <p-floatlabel variant="on" class="w-full">
          <p-password formControlName="password" [feedback]="true" [toggleMask]="true" class="w-full"
            inputStyleClass="w-full" inputId="set-pw" />
          <label for="set-pw">New password</label>
        </p-floatlabel>
        <small class="p-error" *ngIf="form.get('password')?.touched && form.get('password')?.invalid">
          Password must be at least 8 characters.
        </small>
      </div>
      <div class="flex flex-column gap-1">
        <p-floatlabel variant="on" class="w-full">
          <p-password formControlName="confirmPassword" [feedback]="false" [toggleMask]="true" class="w-full"
            inputStyleClass="w-full" inputId="set-pw-confirm" />
          <label for="set-pw-confirm">Confirm password</label>
        </p-floatlabel>
        <small class="p-error" *ngIf="form.get('confirmPassword')?.touched && form.get('confirmPassword')?.errors?.['mismatch']">
          Passwords do not match.
        </small>
      </div>
    </div>

    <div class="flex gap-2 flex-wrap">
      <button pButton type="submit" label="Set password" [loading]="submitting()" [disabled]="submitting()"
        class="p-button-primary"></button>
      <a pButton routerLink="/login" label="Back to login" class="p-button-outlined"></a>
    </div>
    }
  </form>
</section>
