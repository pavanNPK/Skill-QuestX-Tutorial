<header class="app-header">
    <div class="header-content">
        <div class="header-left">
            <div class="title-section">
                <h1 class="page-title">{{ pageTitle }}</h1>
                <nav class="breadcrumbs">
                    @for (crumb of breadcrumbs; track crumb.label; let last = $last) {
                    <span class="breadcrumb-item">
                        <!-- If URL exists, routerLink -->
                        @if (crumb.url && !last) {
                        <a [routerLink]="crumb.url" class="breadcrumb-link" [pTooltip]="crumb.title || crumb.label"
                            tooltipPosition="bottom">
                            @if (crumb.icon) { <i [class]="crumb.icon"></i> }
                            <span class="crumb-text">{{ crumb.label }}</span>
                        </a>
                        }
                        <!-- If Command exists (internal nav), click handler -->
                        @if (crumb.command && !last) {
                        <a (click)="crumb.command()" class="breadcrumb-link clickable"
                            [pTooltip]="crumb.title || crumb.label" tooltipPosition="bottom">
                            @if (crumb.icon) { <i [class]="crumb.icon"></i> }
                            <span class="crumb-text">{{ crumb.label }}</span>
                        </a>
                        }
                        <!-- If neither or last, just text -->
                        @if ((!crumb.url && !crumb.command) || last) {
                        <span class="breadcrumb-current" [pTooltip]="crumb.title || crumb.label"
                            tooltipPosition="bottom">
                            @if (crumb.icon) { <i [class]="crumb.icon"></i> }
                            <span class="crumb-text">{{ crumb.label }}</span>
                        </span>
                        }

                        @if (!last) {
                        <i class="pi pi-chevron-right breadcrumb-separator"></i>
                        }
                    </span>
                    }
                </nav>
            </div>
        </div>

        <div class="header-right">
            <button class="notification-btn" (click)="openNotifications()">
                <i class="pi pi-bell"></i>
                @if (unreadCount > 0) {
                <span class="badge">{{ unreadCount }}</span>
                }
            </button>
        </div>
    </div>
</header>

<!-- Notification Drawer -->
<p-drawer [(visible)]="showDrawer" position="right" [showCloseIcon]="true" (onHide)="closeDrawer()">
    <ng-template pTemplate="header">
        <div class="drawer-header">
            <h3>Notifications</h3>
        </div>
    </ng-template>

    <ng-template pTemplate="content">
        <div class="notifications-list">
            @for (notification of notifications; track notification.id) {
            <div class="notification-item" [class.unread]="!notification.read" (click)="markAsRead(notification)">
                @if (!notification.read) {
                <div class="notification-indicator"></div>
                }
                <div class="notification-content">
                    <h4 class="notification-title">{{ notification.title }}</h4>
                    <p class="notification-message">{{ notification.message }}</p>
                    <span class="notification-time">{{ notification.time }}</span>
                </div>
            </div>
            }

            @if (notifications.length === 0) {
            <div class="empty-state">
                <i class="pi pi-inbox"></i>
                <p>No notifications</p>
            </div>
            }
        </div>
    </ng-template>

    <ng-template pTemplate="footer">
        @if (unreadCount > 0) {
        <div class="drawer-footer">
            <button class="mark-all-btn" (click)="markAllAsRead()">
                <i class="pi pi-check-circle"></i>
                Mark all as read
            </button>
        </div>
        }
    </ng-template>
</p-drawer>